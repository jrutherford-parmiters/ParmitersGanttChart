<!DOCTYPE html> <html lang="en"> <head> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width,initial-scale=1"> <title>Advanced Gantt Chart Builder Pro</title> <style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;background:#f5f7fa;padding:20px}.container{max-width:100%;background:#fff;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,.1);overflow:hidden}.toolbar{background:#2c3e50;color:#fff;padding:15px 20px;display:flex;gap:15px;align-items:center;flex-wrap:wrap}.toolbar h1{font-size:20px;margin-right:auto;display:flex;align-items:center;gap:10px}.toolbar .credit{font-size:10px;opacity:.6;font-weight:400;font-style:italic}.toolbar button,.toolbar input{padding:8px 15px;border:none;border-radius:4px;cursor:pointer;font-size:14px}.toolbar button{background:#3498db;color:#fff;transition:background .3s}.toolbar button:hover{background:#2980b9}.toolbar input[type=date],.toolbar input[type=number]{padding:7px 10px}.toolbar label{font-size:14px}.stats-bar{background:#34495e;color:#fff;padding:12px 20px;display:flex;gap:25px;align-items:center;flex-wrap:wrap;font-size:13px}.stat-item{display:flex;align-items:center;gap:5px}.stat-label{opacity:.8}.stat-value{font-weight:700;font-size:14px}.filter-bar{background:#ecf0f1;padding:12px 20px;display:flex;gap:15px;align-items:center;flex-wrap:wrap;border-bottom:2px solid #bdc3c7}.filter-bar input,.filter-bar select{padding:6px 12px;border:1px solid #bdc3c7;border-radius:4px;font-size:13px}.filter-bar label{font-size:13px;font-weight:500}.gantt-wrapper{display:flex;overflow-x:auto;overflow-y:auto;max-height:60vh}.task-list{min-width:350px;background:#ecf0f1;border-right:2px solid #bdc3c7;position:sticky;left:0;z-index:10}.task-list-header{background:#34495e;color:#fff;padding:12px;font-weight:700;border-bottom:2px solid #2c3e50;height:80px;display:flex;align-items:center}.task-row{padding:8px 12px;border-bottom:1px solid #bdc3c7;display:flex;align-items:center;gap:8px;min-height:50px;background:#fff;position:relative}.task-row:hover{background:#f8f9fa}.task-row:hover .move-buttons{display:flex}.task-indent{width:20px}.task-toggle{cursor:pointer;user-select:none;width:16px;text-align:center}.task-name{flex:1;font-size:13px;display:flex;flex-direction:column;gap:3px}.task-main-name{font-weight:500}.task-meta{font-size:11px;color:#7f8c8d;display:flex;gap:10px}.task-delete{background:#e74c3c;color:#fff;border:none;padding:4px 8px;border-radius:3px;cursor:pointer;font-size:11px}.task-icon{font-size:14px;width:16px;text-align:center}.priority-indicator{width:8px;height:8px;border-radius:50%;display:inline-block}.priority-low{background:#95a5a6}.priority-medium{background:#f39c12}.priority-high{background:#e74c3c}.move-buttons{display:none;gap:2px;margin-left:auto}.move-btn{background:#3498db;color:#fff;border:none;padding:2px 6px;border-radius:3px;cursor:pointer;font-size:11px;font-weight:700}.move-btn:hover{background:#2980b9}.timeline{flex:1;overflow-x:auto;min-width:0}.timeline-header{display:flex;background:#34495e;color:#fff;border-bottom:2px solid #2c3e50;height:80px;flex-direction:column;position:sticky;top:0;z-index:5;min-width:min-content}.day-header,.week-header{min-width:min-content}.week-header{display:flex;height:40px}.week-cell{min-width:140px;padding:8px;border-right:1px solid #2c3e50;text-align:center;font-weight:700;display:flex;align-items:center;justify-content:center}.day-header{display:flex;height:40px}.day-cell{min-width:20px;padding:4px;border-right:1px solid #4a5f7f;text-align:center;font-size:11px;display:flex;align-items:center;justify-content:center}.timeline-grid{position:relative;min-width:min-content}.grid-row{display:flex;min-height:50px;border-bottom:1px solid #ecf0f1;position:relative;min-width:min-content}.grid-cell{min-width:20px;border-right:1px solid #ecf0f1}.grid-cell.weekend{background:#f8f9fa}.task-bar{position:absolute;height:28px;top:11px;border-radius:4px;cursor:move;display:flex;align-items:center;padding:0 8px;font-size:11px;color:#fff;font-weight:500;user-select:none;box-shadow:0 2px 4px rgba(0,0,0,.2);overflow:hidden}.task-bar.parent{background:#2c3e50;height:8px;top:21px;border-radius:2px}.task-bar.child{background:#3498db}.task-bar.critical{background:#e74c3c;border:2px solid #c0392b}.task-bar.high-priority{border:2px solid #e74c3c}.task-bar.milestone{width:20px!important;height:20px;background:#e74c3c;transform:rotate(45deg);top:15px;padding:0;cursor:pointer}.task-bar.deadline{width:3px!important;height:100%;background:#e74c3c;top:0;padding:0;border-radius:0}.today-line{width:2px!important;height:100%;background:#27ae60;top:0;padding:0;border-radius:0;box-shadow:0 0 5px rgba(39,174,96,.5)}.progress-bar{position:absolute;left:0;top:0;height:100%;background:rgba(255,255,255,.3);border-radius:4px 0 0 4px;pointer-events:none}.resize-handle{position:absolute;width:8px;height:100%;top:0;cursor:ew-resize;background:rgba(255,255,255,.3)}.resize-handle.left{left:0}.resize-handle.right{right:0}.dependency-line{position:absolute;stroke:#95a5a6;stroke-width:2;fill:none;pointer-events:none}.dependency-line.critical{stroke:#e74c3c;stroke-width:3}.modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.5);z-index:1000;align-items:center;justify-content:center}.modal.active{display:flex}.modal-content{background:#fff;padding:30px;border-radius:8px;max-width:500px;width:90%;max-height:90vh;overflow-y:auto}.modal-content h2{margin-bottom:20px}.modal-content label{display:block;margin-top:15px;margin-bottom:5px;font-weight:700;font-size:13px}.modal-content input,.modal-content select,.modal-content textarea{width:100%;padding:8px;border:1px solid #bdc3c7;border-radius:4px;font-size:14px}.modal-buttons{margin-top:20px;display:flex;gap:10px;justify-content:flex-end}.modal-buttons button{padding:10px 20px;border:none;border-radius:4px;cursor:pointer;font-size:14px}.modal-buttons .save{background:#27ae60;color:#fff}.modal-buttons .cancel{background:#95a5a6;color:#fff}.help-content{line-height:1.6}.help-content h3{margin-top:15px;margin-bottom:10px;color:#2c3e50}.help-content ul{margin-left:20px;margin-bottom:10px}.help-content li{margin-bottom:5px}select[multiple]{min-height:100px}.color-preview{width:30px;height:30px;border-radius:4px;border:2px solid #bdc3c7;display:inline-block;vertical-align:middle;margin-left:10px}</style> </head> <body> <div class="container"> <div class="toolbar"> <h1>üìä Gantt Chart Builder Pro <span class="credit">Parmiters School Computing Dept</span></h1> <label>Start Date:</label> <input type="date" id="startDate"> <label>Weeks:</label> <input type="number" id="numWeeks" value="8" min="1" max="52" style="width:60px"> <button onclick="updateTimeline()">Update Timeline</button> <button onclick="addTask()">+ Add Task</button> <button onclick="addMilestone()">+ Add Milestone</button> <button onclick="setDeadline()">Set Deadline</button> <button onclick="toggleCriticalPath()" id="criticalPathBtn">Show Critical Path</button> <button onclick="manageAssignees()">üë• Manage Assignees</button> <button onclick="saveProject()">üíæ Save JSON</button> <button onclick="loadProject()">üìÇ Load JSON</button> <button onclick="exportToPNG()">üì∑ Export PNG</button> <button onclick="showHelp()">‚ùì Help</button> </div> <div class="stats-bar"> <div class="stat-item"> <span class="stat-label">Total Tasks:</span> <span class="stat-value" id="statTotal">0</span> </div> <div class="stat-item"> <span class="stat-label">Completed:</span> <span class="stat-value" id="statCompleted">0</span> </div> <div class="stat-item"> <span class="stat-label">In Progress:</span> <span class="stat-value" id="statInProgress">0</span> </div> <div class="stat-item"> <span class="stat-label">Avg Progress:</span> <span class="stat-value" id="statAvgProgress">0%</span> </div> <div class="stat-item"> <span class="stat-label">Duration:</span> <span class="stat-value" id="statDuration">0 days</span> </div> </div> <div class="filter-bar"> <label>üîç Search:</label> <input type="text" id="searchFilter" placeholder="Search tasks..." oninput="applyFilters()"> <label>üë§ Assignee:</label> <select id="assigneeFilter" onchange="applyFilters()"> <option value="">All</option> </select> <label>‚ö° Priority:</label> <select id="priorityFilter" onchange="applyFilters()"> <option value="">All</option> <option value="low">Low</option> <option value="medium">Medium</option> <option value="high">High</option> </select> </div> <div class="gantt-wrapper"> <div class="task-list"> <div class="task-list-header">Task Details</div> <div id="taskListBody"></div> </div> <div class="timeline"> <div class="timeline-header" id="timelineHeader"></div> <div class="timeline-grid" id="timelineGrid"></div> </div> </div> </div> <div class="modal" id="taskModal"> <div class="modal-content"> <h2 id="modalTitle">Add Task</h2> <label>Task Name:</label> <input type="text" id="modalTaskName"> <label>Type:</label> <select id="modalTaskType"> <option value="child">Child Task</option> <option value="parent">Parent Task</option> <option value="milestone">Milestone</option> </select> <label>Start Date:</label> <input type="date" id="modalStartDate"> <label>Duration (days):</label> <input type="number" id="modalDuration" value="3" min="1"> <label>Progress (%):</label> <input type="number" id="modalProgress" value="0" min="0" max="100"> <label>Assignee:</label> <select id="modalAssignee"> <option value="">None</option> </select> <input type="text" id="modalAssigneeCustom" placeholder="Or type new assignee name" style="margin-top:5px"> <label>Priority:</label> <select id="modalPriority"> <option value="low">Low</option> <option value="medium">Medium</option> <option value="high">High</option> </select> <label>Custom Color:</label> <input type="color" id="modalColor" value="#3498db"> <span class="color-preview" id="colorPreview"></span> <label>Parent Task (optional):</label> <select id="modalParent"> <option value="">None</option> </select> <label>Dependencies (tasks that must finish before this one):</label> <select id="modalDependencies" multiple> </select> <small style="color:#7f8c8d;font-size:11px">Hold Ctrl/Cmd to select multiple</small> <div class="modal-buttons"> <button class="cancel" onclick="closeModal()">Cancel</button> <button class="save" onclick="saveTask()">Save</button> </div> </div> </div> <div class="modal" id="helpModal"> <div class="modal-content"> <h2>Gantt Chart Pro - User Guide</h2> <div class="help-content"> <h3>Key Features</h3> <ul> <li><strong>Task Management:</strong> Create parent tasks, child tasks, and milestones</li> <li><strong>Dependencies:</strong> Link tasks that depend on each other</li> <li><strong>Critical Path:</strong> Automatically identifies the longest sequence of dependent tasks</li> <li><strong>Progress Tracking:</strong> Set completion percentage for each task</li> <li><strong>Filtering:</strong> Search and filter by assignee and priority</li> </ul> <h3>How to Use</h3> <ul> <li><strong>Add Tasks:</strong> Click "+ Add Task" button</li> <li><strong>Edit Tasks:</strong> Double-click task name in the list</li> <li><strong>Move Tasks:</strong> Drag task bars left/right to change dates</li> <li><strong>Resize Tasks:</strong> Drag the edges of task bars to change duration</li> <li><strong>Collapse/Expand:</strong> Click ‚ñº/‚ñ∂ next to parent tasks</li> <li><strong>Reorder:</strong> Use ‚Üë/‚Üì buttons when hovering over tasks</li> </ul> <h3>Dependencies & Critical Path</h3> <ul> <li>Select dependencies when creating/editing tasks</li> <li>Grey lines show task dependencies</li> <li>Click "Show Critical Path" to highlight the longest task chain</li> <li>Critical path tasks appear in red</li> </ul> <h3>Visual Indicators</h3> <ul> <li><strong>Colored dots:</strong> Task priority (grey=low, orange=medium, red=high)</li> <li><strong>Progress bars:</strong> White overlay shows task completion</li> <li><strong>Green line:</strong> Today's date</li> <li><strong>Red line:</strong> Project deadline</li> </ul> <h3>Save & Export</h3> <ul> <li><strong>Save JSON:</strong> Download project as JSON file</li> <li><strong>Load JSON:</strong> Import previously saved project</li> <li><strong>Export PNG:</strong> Download chart as PNG image</li> </ul> </div> <div class="modal-buttons"> <button class="cancel" onclick="closeHelp()">Close</button> </div> </div> </div> <div class="modal" id="assigneeModal"> <div class="modal-content"> <h2>Manage Team Assignees</h2> <div style="margin-bottom:15px"> <label style="display:block;margin-bottom:5px">Add New Assignee:</label> <div style="display:flex;gap:10px"> <input type="text" id="newAssigneeName" placeholder="Enter name" style="flex:1"> <button onclick="addAssignee()" style="background:#27ae60;color:#fff;border:none;padding:8px 15px;border-radius:4px;cursor:pointer">Add</button> </div> </div> <div> <label style="display:block;margin-bottom:5px;font-weight:700">Current Assignees:</label> <div id="assigneeList" style="max-height:300px;overflow-y:auto;border:1px solid #bdc3c7;border-radius:4px;padding:10px"> </div> </div> <div class="modal-buttons"> <button class="cancel" onclick="closeAssigneeModal()">Close</button> </div> </div> </div> <input type="file" id="fileInput" style="display:none" accept=".json"> <script>let startDate=new Date;startDate.setHours(0,0,0,0);let numWeeks=8,tasks=[],deadline=null,draggedTask=null,resizeTask=null,resizeDirection=null,dragStartX=0,editingTaskId=null,showCritical=!1,criticalPath=[],filteredTasks=[],assigneeList=[];const dayWidth=20;function initializeDate(){const e=document.getElementById("startDate"),t=new Date;t.setHours(0,0,0,0),e.value=t.toISOString().split("T")[0],startDate=new Date(t)}function updateTimeline(){const e=document.getElementById("startDate").value;e&&(startDate=new Date(e),startDate.setHours(0,0,0,0)),numWeeks=parseInt(document.getElementById("numWeeks").value)||8,applyFilters()}function applyFilters(){const e=document.getElementById("searchFilter").value.toLowerCase(),t=document.getElementById("assigneeFilter").value,n=document.getElementById("priorityFilter").value;filteredTasks=tasks.filter(a=>{const s=a.name.toLowerCase().includes(e)||(a.assignee&&a.assignee.toLowerCase().includes(e)),r=!t||a.assignee===t,o=!n||a.priority===n;return s&&r&&o}),updateAssigneeFilter(),calculateCriticalPath(),updateStats(),render()}function updateAssigneeFilter(){const e=document.getElementById("assigneeFilter"),t=e.value,n=[...new Set([...assigneeList,...tasks.map(e=>e.assignee).filter(Boolean)])];e.innerHTML='<option value="">All</option>',n.forEach(t=>{e.innerHTML+=`<option value="${t}">${t}</option>`}),e.value=t}function manageAssignees(){renderAssigneeList(),document.getElementById("assigneeModal").classList.add("active")}function renderAssigneeList(){const e=document.getElementById("assigneeList");0===assigneeList.length?e.innerHTML='<p style="color:#7f8c8d;font-style:italic">No assignees added yet</p>':e.innerHTML=assigneeList.map(e=>` <div style="display:flex;align-items:center;padding:8px;border-bottom:1px solid #ecf0f1;gap:10px;"> <span style="flex:1;font-size:14px;">${e}</span> <button onclick="removeAssignee('${e}')" style="background:#e74c3c;color:#fff;border:none;padding:4px 8px;border-radius:3px;cursor:pointer;font-size:11px;">Remove</button> </div> `).join("")}function addAssignee(){const e=document.getElementById("newAssigneeName").value.trim();if(!e)return void alert("Please enter an assignee name");if(assigneeList.includes(e))return void alert("This assignee already exists");assigneeList.push(e),document.getElementById("newAssigneeName").value="",renderAssigneeList(),updateAssigneeFilter()}function removeAssignee(e){confirm(`Remove "${e}" from assignee list?\n\nNote: This won't remove them from existing tasks.`)&&(assigneeList=assigneeList.filter(t=>t!==e),renderAssigneeList(),updateAssigneeFilter())}function closeAssigneeModal(){document.getElementById("assigneeModal").classList.remove("active")}function calculateCriticalPath(){if(criticalPath=[],0===tasks.length)return;const e={};tasks.forEach(t=>{e[t.id]={...t,earlyStart:0,earlyFinish:0,lateStart:1/0,lateFinish:1/0,slack:0}}),tasks.forEach(t=>{const n=e[t.id];if(t.dependencies&&t.dependencies.length>0){let e=0;t.dependencies.forEach(t=>{const a=n[t];a&&(e=Math.max(e,a.earlyFinish))}),n.earlyStart=e}else{const e=Math.floor((new Date(t.start)-startDate)/864e5);n.earlyStart=e}n.earlyFinish=n.earlyStart+(t.duration||1)});const t=Math.max(...Object.values(e).map(e=>e.earlyFinish));[...tasks].reverse().forEach(n=>{const a=e[n.id],s=tasks.filter(e=>e.dependencies&&e.dependencies.includes(n.id));0===s.length?a.lateFinish=t:a.lateFinish=Math.min(...s.map(t=>e[t.id].lateStart)),a.lateStart=a.lateFinish-(n.duration||1),a.slack=a.lateStart-a.earlyStart}),criticalPath=tasks.filter(t=>{const n=e[t.id];return Math.abs(n.slack)<.01}).map(e=>e.id)}function toggleCriticalPath(){showCritical=!showCritical;const e=document.getElementById("criticalPathBtn");e.textContent=showCritical?"Hide Critical Path":"Show Critical Path",e.style.background=showCritical?"#e74c3c":"#3498db",render()}function updateStats(){const e=tasks.filter(e=>"milestone"!==e.type).length,t=tasks.filter(e=>"milestone"!==e.type&&100===e.progress).length,n=tasks.filter(e=>"milestone"!==e.type&&e.progress>0&&e.progress<100).length,a=e>0?Math.round(tasks.filter(e=>"milestone"!==e.type).reduce((e,t)=>e+(t.progress||0),0)/e):0;let s=null,r=null;tasks.forEach(e=>{if("milestone"===e.type)return;const t=new Date(e.start),n=new Date(t);n.setDate(n.getDate()+(e.duration||1)),(!s||t<s)&&(s=t),(!r||n>r)&&(r=n)});const o=s&&r?Math.ceil((r-s)/864e5):0;document.getElementById("statTotal").textContent=e,document.getElementById("statCompleted").textContent=t,document.getElementById("statInProgress").textContent=n,document.getElementById("statAvgProgress").textContent=a+"%",document.getElementById("statDuration").textContent=o+" days"}function render(){renderTimelineHeader(),renderTimelineGrid(),renderTaskList()}function renderTimelineHeader(){const e=document.getElementById("timelineHeader");let t='<div class="week-header">',n='<div class="day-header">';for(let e=0;e<numWeeks;e++){const a=new Date(startDate);a.setDate(startDate.getDate()+7*e);const s=new Date(a);s.setDate(a.getDate()+6),t+=`<div class="week-cell">${formatDate(a)} - ${formatDate(s)}</div>`;for(let e=0;e<7;e++){const t=new Date(a);t.setDate(a.getDate()+e);const s=["S","M","T","W","T","F","S"][t.getDay()];n+=`<div class="day-cell">${s}</div>`}}t+="</div>",n+="</div>",e.innerHTML=t+n}function renderTimelineGrid(){const e=document.getElementById("timelineGrid"),t=7*numWeeks;e.innerHTML="";const n="http://www.w3.org/2000/svg",a=document.createElementNS(n,"svg");a.style.position="absolute",a.style.top="0",a.style.left="0",a.style.width="100%",a.style.height="100%",a.style.pointerEvents="none",a.style.zIndex="1",filteredTasks.forEach((n,a)=>{if(!isTaskVisible(n))return;if("milestone"!==n.type){const s=document.createElement("div");s.className="grid-row";for(let e=0;e<t;e++){const n=new Date(startDate);n.setDate(startDate.getDate()+e);const a=0===n.getDay()||6===n.getDay(),t=document.createElement("div");t.className="grid-cell"+(a?" weekend":""),s.appendChild(t)}const r=createTaskBar(n,a);s.appendChild(r),e.appendChild(s)}}),filteredTasks.forEach((t,s)=>{t.dependencies&&t.dependencies.length>0&&t.dependencies.forEach(r=>{const o=tasks.find(e=>e.id===r);if(o&&filteredTasks.includes(t)&&filteredTasks.includes(o)){const r=getTaskRowIndex(tasks.indexOf(o)),l=getTaskRowIndex(tasks.indexOf(t));if(r>=0&&l>=0){const i=Math.floor((new Date(o.start)-startDate)/864e5)+(o.duration||1),d=Math.floor((new Date(t.start)-startDate)/864e5),c=i*dayWidth,p=50*r+25,u=d*dayWidth,f=50*l+25,m=document.createElementNS(n,"path"),g=(c+u)/2,h=`M ${c} ${p} L ${g} ${p} L ${g} ${f} L ${u} ${f}`;m.setAttribute("d",h),m.setAttribute("class",showCritical&&criticalPath.includes(t.id)&&criticalPath.includes(o.id)?"dependency-line critical":"dependency-line"),a.appendChild(m)}}})}),e.appendChild(a);const s=document.createElement("div");s.style.position="absolute",s.style.width="100%",s.style.height="100%",s.style.top="0",s.style.pointerEvents="none",s.style.zIndex="2",filteredTasks.forEach((e,t)=>{if("milestone"===e.type){const n=Math.floor((new Date(e.start)-startDate)/864e5),a=getTaskRowIndex(tasks.indexOf(e));if(n>=0&&n<7*numWeeks&&a>=0){const s=document.createElement("div");s.className="task-bar milestone",s.style.left=`${n*dayWidth+10}px`,s.style.top=`${50*a+15}px`,s.style.pointerEvents="auto",s.title=e.name,s.addEventListener("mousedown",t=>startDrag(t,e,tasks.indexOf(e))),s.appendChild(s)}}});const r=new Date;r.setHours(0,0,0,0);const o=Math.floor((r-startDate)/864e5);if(o>=0&&o<7*numWeeks){const t=document.createElement("div");t.className="task-bar today-line",t.style.left=`${o*dayWidth}px`,t.style.top="0",t.style.height=`${e.scrollHeight}px`,t.title=`Today: ${formatDate(r)}`,s.appendChild(t)}if(deadline){const t=Math.floor((new Date(deadline)-startDate)/864e5);if(t>=0&&t<7*numWeeks){const n=document.createElement("div");n.className="task-bar deadline",n.style.left=`${t*dayWidth}px`,n.style.top="0",n.style.height=`${e.scrollHeight}px`,n.title=`Deadline: ${formatDate(new Date(deadline))}`,s.appendChild(n)}}e.appendChild(s)}function getTaskRowIndex(e){let t=0;for(let n=0;n<e;n++)isTaskVisible(tasks[n])&&filteredTasks.includes(tasks[n])&&"milestone"!==tasks[n].type&&t++;return isTaskVisible(tasks[e])&&filteredTasks.includes(tasks[e])?t:-1}function createTaskBar(e,t){const n=Math.floor((new Date(e.start)-startDate)/864e5),a=e.duration||1,s=document.createElement("div");s.className=`task-bar ${e.type}`,showCritical&&criticalPath.includes(e.id)?s.classList.add("critical"):"high"===e.priority&&!showCritical&&s.classList.add("high-priority"),s.style.left=`${n*dayWidth}px`,s.style.width=`${a*dayWidth}px`,e.color&&"parent"!==e.type&&(s.style.background=e.color);let r=`${e.name}\nStart: ${formatDate(new Date(e.start))}\nDuration: ${a} days`;if(e.assignee&&(r+=`\nAssignee: ${e.assignee}`),void 0!==e.progress&&(r+=`\nProgress: ${e.progress}%`),e.priority&&(r+=`\nPriority: ${e.priority}`),s.title=r,s.addEventListener("mousedown",t=>{t.target.classList.contains("resize-handle")||startDrag(t,e,tasks.indexOf(e))}),e.progress>0&&"parent"!==e.type){const t=document.createElement("div");t.className="progress-bar",t.style.width=`${e.progress}%`,s.appendChild(t)}if("parent"!==e.type){const t=document.createElement("div");t.className="resize-handle left",t.addEventListener("mousedown",t=>startResize(t,e,tasks.indexOf(e),"left")),s.appendChild(t);const n=document.createElement("div");n.className="resize-handle right",n.addEventListener("mousedown",t=>startResize(t,e,tasks.indexOf(e),"right")),s.appendChild(n)}return s}function renderTaskList(){const e=document.getElementById("taskListBody");e.innerHTML="",filteredTasks.forEach((t,n)=>{if(isTaskVisible(t)){const a=document.createElement("div");a.className="task-row";const s=t.parentId?'<span class="task-indent"></span>':"",r="parent"===t.type?`<span class="task-toggle" onclick="toggleCollapse(${t.id})">${t.collapsed?"‚ñ∂":"‚ñº"}</span>`:'<span class="task-indent"></span>',o=getTaskIcon(t.type),l=t.priority?`<span class="priority-indicator priority-${t.priority}"></span>`:"",i=tasks.indexOf(t),d=[];t.assignee&&d.push(`üë§ ${t.assignee}`),void 0!==t.progress&&d.push(`${t.progress}%`);const c=d.length>0?`<div class="task-meta">${d.join(" ‚Ä¢ ")}</div>`:"";a.innerHTML=` ${s} ${r} ${l} <span class="task-icon">${o}</span> <span class="task-name" ondblclick="editTask(${t.id})"> <div class="task-main-name">${t.name}</div> ${c} </span> <div class="move-buttons"> <button class="move-btn" onclick="moveTask(${i},-1)" ${0===i?"disabled":""}>‚Üë</button> <button class="move-btn" onclick="moveTask(${i},1)" ${i===tasks.length-1?"disabled":""}>‚Üì</button> </div> <button class="task-delete" onclick="deleteTask(${t.id})">√ó</button> `,e.appendChild(a)}})}function getTaskIcon(e){switch(e){case"parent":return"üìÅ";case"child":return"üìÑ";case"milestone":return"üèÅ";default:return"üìÑ"}}function moveTask(e,t){const n=e+t;if(n<0||n>=tasks.length)return;const a=tasks[e];tasks[e]=tasks[n],tasks[n]=a,applyFilters()}function startDrag(e,t,n){e.preventDefault(),e.stopPropagation(),draggedTask={task:t,index:n},dragStartX=e.clientX,document.addEventListener("mousemove",drag),document.addEventListener("mouseup",stopDrag)}function drag(e){if(draggedTask){const t=e.clientX-dragStartX,n=Math.round(t/dayWidth);if(0!==n){const t=new Date(draggedTask.task.start);t.setDate(t.getDate()+n),draggedTask.task.start=t.toISOString().split("T")[0],dragStartX=e.clientX,render()}}}function stopDrag(){draggedTask=null,document.removeEventListener("mousemove",drag),document.removeEventListener("mouseup",stopDrag)}function startResize(e,t,n,a){e.preventDefault(),e.stopPropagation(),resizeTask={task:t,index:n},resizeDirection=a,dragStartX=e.clientX,document.addEventListener("mousemove",resize),document.addEventListener("mouseup",stopResize)}function resize(e){if(resizeTask){const t=e.clientX-dragStartX,n=Math.round(t/dayWidth);if(0!==n){if("left"===resizeDirection){const e=new Date(resizeTask.task.start);e.setDate(e.getDate()+n),resizeTask.task.start=e.toISOString().split("T")[0],resizeTask.task.duration=Math.max(1,resizeTask.task.duration-n)}else resizeTask.task.duration=Math.max(1,resizeTask.task.duration+n);dragStartX=e.clientX,render()}}}function stopResize(){resizeTask=null,resizeDirection=null,document.removeEventListener("mousemove",resize),document.removeEventListener("mouseup",stopResize)}function toggleCollapse(e){const t=tasks.find(t=>t.id===e);t&&(t.collapsed=!t.collapsed,applyFilters())}function addTask(){editingTaskId=null,document.getElementById("modalTitle").textContent="Add Task",document.getElementById("modalTaskName").value="",document.getElementById("modalTaskType").value="child",document.getElementById("modalStartDate").value=startDate.toISOString().split("T")[0],document.getElementById("modalDuration").value=3,document.getElementById("modalProgress").value=0,updateAssigneeSelect(),document.getElementById("modalAssigneeCustom").value="",document.getElementById("modalPriority").value="medium",document.getElementById("modalColor").value="#3498db",updateColorPreview(),updateParentSelect(),updateDependencySelect(),document.getElementById("taskModal").classList.add("active")}function addMilestone(){editingTaskId=null,document.getElementById("modalTitle").textContent="Add Milestone",document.getElementById("modalTaskName").value="",document.getElementById("modalTaskType").value="milestone",document.getElementById("modalStartDate").value=startDate.toISOString().split("T")[0],document.getElementById("modalDuration").value=1,document.getElementById("modalProgress").value=0,updateAssigneeSelect(),document.getElementById("modalAssigneeCustom").value="",document.getElementById("modalPriority").value="high",document.getElementById("modalColor").value="#e74c3c",updateColorPreview(),updateParentSelect(),updateDependencySelect(),document.getElementById("taskModal").classList.add("active")}function editTask(e){const t=tasks.find(t=>t.id===e);if(!t)return;editingTaskId=e,document.getElementById("modalTitle").textContent="Edit Task",document.getElementById("modalTaskName").value=t.name,document.getElementById("modalTaskType").value=t.type,document.getElementById("modalStartDate").value=t.start,document.getElementById("modalDuration").value=t.duration||1,document.getElementById("modalProgress").value=t.progress||0,updateAssigneeSelect(),document.getElementById("modalAssignee").value=t.assignee||"",document.getElementById("modalAssigneeCustom").value="",document.getElementById("modalPriority").value=t.priority||"medium",document.getElementById("modalColor").value=t.color||"#3498db",updateColorPreview(),updateParentSelect(),updateDependencySelect(),document.getElementById("modalParent").value=t.parentId||"";const n=document.getElementById("modalDependencies");Array.from(n.options).forEach(e=>{e.selected=t.dependencies&&t.dependencies.includes(parseInt(e.value))}),document.getElementById("taskModal").classList.add("active")}function updateAssigneeSelect(){const e=document.getElementById("modalAssignee"),t=[...new Set([...assigneeList,...tasks.map(e=>e.assignee).filter(Boolean)])];e.innerHTML='<option value="">None</option>',t.forEach(t=>{e.innerHTML+=`<option value="${t}">${t}</option>`})}function updateParentSelect(){const e=document.getElementById("modalParent");e.innerHTML='<option value="">None</option>',tasks.filter(e=>"parent"===e.type).forEach(t=>{editingTaskId!==t.id&&(e.innerHTML+=`<option value="${t.id}">${t.name}</option>`)})}function isTaskVisible(e){if(!e.parentId)return!0;const t=tasks.find(t=>t.id==e.parentId);return!t||(!t.collapsed&&isTaskVisible(t))}function updateDependencySelect(){const e=document.getElementById("modalDependencies");e.innerHTML="",tasks.forEach(t=>{editingTaskId!==t.id&&"milestone"!==t.type&&(e.innerHTML+=`<option value="${t.id}">${t.name}</option>`)})}function updateColorPreview(){const e=document.getElementById("modalColor").value;document.getElementById("colorPreview").style.background=e}document.getElementById("modalColor").addEventListener("input",updateColorPreview);function saveTask(){const e=document.getElementById("modalTaskName").value,t=document.getElementById("modalTaskType").value,n=document.getElementById("modalStartDate").value,a=parseInt(document.getElementById("modalDuration").value)||1,s=parseInt(document.getElementById("modalProgress").value)||0,r=document.getElementById("modalAssignee").value,o=document.getElementById("modalAssigneeCustom").value.trim(),l=o||r||null,i=document.getElementById("modalPriority").value,d=document.getElementById("modalColor").value,c=document.getElementById("modalParent").value,p=c?parseInt(c):null,u=document.getElementById("modalDependencies"),f=Array.from(u.selectedOptions).map(e=>parseInt(e.value));if(!e)return void alert("Please enter a task name");if(o&&!assigneeList.includes(o)&&assigneeList.push(o),null!==editingTaskId){const r=tasks.find(e=>e.id===editingTaskId);r&&(r.name=e,r.type=t,r.start=n,r.duration=a,r.progress=s,r.assignee=l,r.priority=i,r.color=d,r.parentId=p,r.dependencies=f)}else{const r={id:Date.now(),name:e,type:t,start:n,duration:a,progress:s,assignee:l,priority:i,color:d,parentId:p,dependencies:f,collapsed:!1};tasks.push(r)}closeModal(),applyFilters()}function deleteTask(e){confirm("Are you sure you want to delete this task?")&&(tasks=tasks.filter(t=>!(t.id===e||t.parentId===e)&&(t.dependencies&&(t.dependencies=t.dependencies.filter(t=>t!==e)),!0)),applyFilters())}function closeModal(){document.getElementById("taskModal").classList.remove("active")}function showHelp(){document.getElementById("helpModal").classList.add("active")}function closeHelp(){document.getElementById("helpModal").classList.remove("active")}function setDeadline(){const e=prompt("Enter deadline date (YYYY-MM-DD):",deadline||"");e?(deadline=e,render()):""===e&&(deadline=null,render())}function saveProject(){const e={startDate:startDate.toISOString().split("T")[0],numWeeks,tasks,deadline,assigneeList},t=JSON.stringify(e,null,2),n=new Blob([t],{type:"application/json"}),a=URL.createObjectURL(n),s=document.createElement("a");s.href=a,s.download="gantt-project.json",s.click(),URL.revokeObjectURL(a)}function loadProject(){document.getElementById("fileInput").click()}function exportToPNG(){const e=document.querySelector(".container"),t=document.querySelector(".gantt-wrapper"),n=t.style.maxHeight,a=t.style.overflow;t.style.maxHeight="none",t.style.overflow="visible";const s=document.createElement("script");s.src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js",s.onload=()=>{html2canvas(e,{backgroundColor:"#ffffff",scale:2,logging:!1,useCORS:!0}).then(e=>{t.style.maxHeight=n,t.style.overflow=a,e.toBlob(e=>{const t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download=`gantt-chart-${(new Date).toISOString().split("T")[0]}.png`,n.click(),URL.revokeObjectURL(t)})}).catch(e=>{t.style.maxHeight=n,t.style.overflow=a,alert("Error exporting PNG: "+e.message)})},s.onerror=()=>{t.style.maxHeight=n,t.style.overflow=a,alert("Failed to load export library. Please check your internet connection.")},document.head.appendChild(s)}document.getElementById("fileInput").addEventListener("change",e=>{const t=e.target.files[0];if(t){const n=new FileReader;n.onload=e=>{try{const t=JSON.parse(e.target.result);startDate=new Date(t.startDate),numWeeks=t.numWeeks,tasks=t.tasks||[],deadline=t.deadline,assigneeList=t.assigneeList||[],document.getElementById("startDate").value=t.startDate,document.getElementById("numWeeks").value=t.numWeeks,applyFilters()}catch(e){alert("Error loading project file: "+e.message)}},n.readAsText(t),e.target.value=""}});function formatDate(e){const t=e.getMonth()+1,n=e.getDate();return`${t}/${n}`}initializeDate(),updateTimeline();</script> </body> </html>